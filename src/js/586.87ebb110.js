"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[586],{7586:function(e,l,a){a.r(l),a.d(l,{default:function(){return c}});var o=a(641);const t={class:"settings-container"};function r(e,l,a,r,s,d){const u=(0,o.g2)("el-input"),i=(0,o.g2)("el-form-item"),n=(0,o.g2)("el-button"),p=(0,o.g2)("el-form"),m=(0,o.g2)("el-tab-pane"),c=(0,o.g2)("el-divider"),f=(0,o.g2)("el-input-number"),b=(0,o.g2)("el-option"),_=(0,o.g2)("el-select"),F=(0,o.g2)("el-tabs"),k=(0,o.g2)("el-card");return(0,o.uX)(),(0,o.CE)("div",t,[(0,o.bF)(k,null,{header:(0,o.k6)(()=>l[19]||(l[19]=[(0,o.Lk)("div",{class:"card-header"},[(0,o.Lk)("span",null,"个人设置")],-1)])),default:(0,o.k6)(()=>[(0,o.bF)(F,{modelValue:r.activeTab,"onUpdate:modelValue":l[18]||(l[18]=e=>r.activeTab=e)},{default:(0,o.k6)(()=>[(0,o.bF)(m,{label:"个人信息",name:"profile"},{default:(0,o.k6)(()=>[(0,o.bF)(p,{model:r.profileForm,"label-width":"100px",rules:r.profileRules,ref:"profileFormRef",class:"settings-form"},{default:(0,o.k6)(()=>[(0,o.bF)(i,{label:"用户名",prop:"username"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{modelValue:r.profileForm.username,"onUpdate:modelValue":l[0]||(l[0]=e=>r.profileForm.username=e),placeholder:"请输入用户名"},null,8,["modelValue"])]),_:1}),(0,o.bF)(i,{label:"邮箱",prop:"email"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{modelValue:r.profileForm.email,"onUpdate:modelValue":l[1]||(l[1]=e=>r.profileForm.email=e),placeholder:"请输入邮箱",type:"email"},null,8,["modelValue"])]),_:1}),(0,o.bF)(i,null,{default:(0,o.k6)(()=>[(0,o.bF)(n,{type:"primary",onClick:r.updateProfile,loading:r.profileSubmitting},{default:(0,o.k6)(()=>l[20]||(l[20]=[(0,o.eW)("保存")])),_:1,__:[20]},8,["onClick","loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1}),(0,o.bF)(m,{label:"修改密码",name:"password"},{default:(0,o.k6)(()=>[(0,o.bF)(p,{model:r.passwordForm,"label-width":"120px",rules:r.passwordRules,ref:"passwordFormRef",class:"settings-form"},{default:(0,o.k6)(()=>[(0,o.bF)(i,{label:"当前密码",prop:"currentPassword"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{modelValue:r.passwordForm.currentPassword,"onUpdate:modelValue":l[2]||(l[2]=e=>r.passwordForm.currentPassword=e),placeholder:"请输入当前密码",type:"password","show-password":""},null,8,["modelValue"])]),_:1}),(0,o.bF)(i,{label:"新密码",prop:"newPassword"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{modelValue:r.passwordForm.newPassword,"onUpdate:modelValue":l[3]||(l[3]=e=>r.passwordForm.newPassword=e),placeholder:"请输入新密码",type:"password","show-password":""},null,8,["modelValue"])]),_:1}),(0,o.bF)(i,{label:"确认新密码",prop:"confirmPassword"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{modelValue:r.passwordForm.confirmPassword,"onUpdate:modelValue":l[4]||(l[4]=e=>r.passwordForm.confirmPassword=e),placeholder:"请再次输入新密码",type:"password","show-password":""},null,8,["modelValue"])]),_:1}),(0,o.bF)(i,null,{default:(0,o.k6)(()=>[(0,o.bF)(n,{type:"primary",onClick:r.updatePassword,loading:r.passwordSubmitting},{default:(0,o.k6)(()=>l[21]||(l[21]=[(0,o.eW)("保存")])),_:1,__:[21]},8,["onClick","loading"])]),_:1})]),_:1},8,["model","rules"])]),_:1}),(0,o.bF)(m,{label:"API设置",name:"api"},{default:(0,o.k6)(()=>[(0,o.bF)(p,{model:r.apiForm,"label-width":"150px",ref:"apiFormRef",class:"settings-form"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{"content-position":"left"},{default:(0,o.k6)(()=>l[22]||(l[22]=[(0,o.eW)("Coze API 配置")])),_:1,__:[22]}),(0,o.bF)(i,{label:"Coze API令牌",prop:"cozeApiToken"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{modelValue:r.apiForm.cozeApiToken,"onUpdate:modelValue":l[5]||(l[5]=e=>r.apiForm.cozeApiToken=e),placeholder:"请输入Coze API访问令牌（PAT）",type:"password","show-password":"",clearable:""},null,8,["modelValue"]),l[23]||(l[23]=(0,o.Lk)("div",{class:"form-tip"},"个人访问令牌，以pat_开头的字符串",-1))]),_:1,__:[23]}),(0,o.bF)(i,{label:"工作流ID",prop:"cozeWorkflowId"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{modelValue:r.apiForm.cozeWorkflowId,"onUpdate:modelValue":l[6]||(l[6]=e=>r.apiForm.cozeWorkflowId=e),placeholder:"请输入Coze工作流ID",clearable:""},null,8,["modelValue"]),l[24]||(l[24]=(0,o.Lk)("div",{class:"form-tip"},"已发布的生成商品描述工作流ID",-1))]),_:1,__:[24]}),(0,o.bF)(i,{label:"智能体ID",prop:"cozeBotId"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{modelValue:r.apiForm.cozeBotId,"onUpdate:modelValue":l[7]||(l[7]=e=>r.apiForm.cozeBotId=e),placeholder:"请输入智能体ID（可选）",clearable:""},null,8,["modelValue"]),l[25]||(l[25]=(0,o.Lk)("div",{class:"form-tip"},"可选，如果工作流需要关联智能体，则需填写",-1))]),_:1,__:[25]}),(0,o.bF)(i,null,{default:(0,o.k6)(()=>[(0,o.bF)(n,{type:"primary",onClick:r.updateApiSettings,loading:r.apiSubmitting},{default:(0,o.k6)(()=>l[26]||(l[26]=[(0,o.eW)("保存")])),_:1,__:[26]},8,["onClick","loading"]),(0,o.bF)(n,{onClick:r.testCozeApi,loading:r.apiTesting},{default:(0,o.k6)(()=>l[27]||(l[27]=[(0,o.eW)("测试连接")])),_:1,__:[27]},8,["onClick","loading"])]),_:1})]),_:1},8,["model"])]),_:1}),(0,o.bF)(m,{label:"默认参数设置",name:"defaults"},{default:(0,o.k6)(()=>[(0,o.bF)(p,{model:r.defaultsForm,"label-width":"150px",ref:"defaultsFormRef",class:"settings-form"},{default:(0,o.k6)(()=>[(0,o.bF)(c,{"content-position":"left"},{default:(0,o.k6)(()=>l[28]||(l[28]=[(0,o.eW)("闲鱼商品默认参数")])),_:1,__:[28]}),(0,o.bF)(i,{label:"商品业务类型",prop:"item_biz_type"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{modelValue:r.defaultsForm.item_biz_type,"onUpdate:modelValue":l[8]||(l[8]=e=>r.defaultsForm.item_biz_type=e),min:1,step:1},null,8,["modelValue"]),l[29]||(l[29]=(0,o.Lk)("div",{class:"form-tip"},"默认值: 2",-1))]),_:1,__:[29]}),(0,o.bF)(i,{label:"特殊业务类型",prop:"sp_biz_type"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{modelValue:r.defaultsForm.sp_biz_type,"onUpdate:modelValue":l[9]||(l[9]=e=>r.defaultsForm.sp_biz_type=e),min:1,step:1},null,8,["modelValue"]),l[30]||(l[30]=(0,o.Lk)("div",{class:"form-tip"},"默认值: 21",-1))]),_:1,__:[30]}),(0,o.bF)(i,{label:"商品类目ID",prop:"channel_cat_id"},{default:(0,o.k6)(()=>[(0,o.bF)(u,{modelValue:r.defaultsForm.channel_cat_id,"onUpdate:modelValue":l[10]||(l[10]=e=>r.defaultsForm.channel_cat_id=e),placeholder:"请输入商品类目ID"},null,8,["modelValue"]),l[31]||(l[31]=(0,o.Lk)("div",{class:"form-tip"},"默认值: 9296cbae4daae3c4267e0a01017d9f44",-1))]),_:1,__:[31]}),(0,o.bF)(i,{label:"运费",prop:"express_fee"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{modelValue:r.defaultsForm.express_fee,"onUpdate:modelValue":l[11]||(l[11]=e=>r.defaultsForm.express_fee=e),min:0,precision:2},null,8,["modelValue"]),l[32]||(l[32]=(0,o.Lk)("div",{class:"form-tip"},"默认值: 0.00",-1))]),_:1,__:[32]}),(0,o.bF)(i,{label:"库存",prop:"stock"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{modelValue:r.defaultsForm.stock,"onUpdate:modelValue":l[12]||(l[12]=e=>r.defaultsForm.stock=e),min:1,step:1},null,8,["modelValue"]),l[33]||(l[33]=(0,o.Lk)("div",{class:"form-tip"},"默认值: 1",-1))]),_:1,__:[33]}),(0,o.bF)(i,{label:"新旧程度",prop:"stuff_status"},{default:(0,o.k6)(()=>[(0,o.bF)(_,{modelValue:r.defaultsForm.stuff_status,"onUpdate:modelValue":l[13]||(l[13]=e=>r.defaultsForm.stuff_status=e),placeholder:"请选择新旧程度"},{default:(0,o.k6)(()=>[(0,o.bF)(b,{label:"全新",value:0}),(0,o.bF)(b,{label:"9成新",value:1}),(0,o.bF)(b,{label:"8成新",value:2}),(0,o.bF)(b,{label:"7成新",value:3}),(0,o.bF)(b,{label:"6成新",value:4}),(0,o.bF)(b,{label:"5成新及以下",value:5})]),_:1},8,["modelValue"]),l[34]||(l[34]=(0,o.Lk)("div",{class:"form-tip"},"默认值: 0 (全新)",-1))]),_:1,__:[34]}),(0,o.bF)(i,{label:"规格类型",prop:"spec_type"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{modelValue:r.defaultsForm.spec_type,"onUpdate:modelValue":l[14]||(l[14]=e=>r.defaultsForm.spec_type=e),min:1,max:3,step:1},null,8,["modelValue"]),l[35]||(l[35]=(0,o.Lk)("div",{class:"form-tip"},"默认值: 1",-1))]),_:1,__:[35]}),(0,o.bF)(c,{"content-position":"left"},{default:(0,o.k6)(()=>l[36]||(l[36]=[(0,o.eW)("发布计划默认参数")])),_:1,__:[36]}),(0,o.bF)(i,{label:"默认发布数量",prop:"default_publish_count"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{modelValue:r.defaultsForm.default_publish_count,"onUpdate:modelValue":l[15]||(l[15]=e=>r.defaultsForm.default_publish_count=e),min:1,max:100,step:1},null,8,["modelValue"]),l[37]||(l[37]=(0,o.Lk)("div",{class:"form-tip"},"默认值: 5",-1))]),_:1,__:[37]}),(0,o.bF)(i,{label:"默认图片数量",prop:"default_image_count"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{modelValue:r.defaultsForm.default_image_count,"onUpdate:modelValue":l[16]||(l[16]=e=>r.defaultsForm.default_image_count=e),min:1,max:9,step:1},null,8,["modelValue"]),l[38]||(l[38]=(0,o.Lk)("div",{class:"form-tip"},"默认值: 3",-1))]),_:1,__:[38]}),(0,o.bF)(i,{label:"默认价格",prop:"default_price"},{default:(0,o.k6)(()=>[(0,o.bF)(f,{modelValue:r.defaultsForm.default_price,"onUpdate:modelValue":l[17]||(l[17]=e=>r.defaultsForm.default_price=e),min:0,precision:2},null,8,["modelValue"]),l[39]||(l[39]=(0,o.Lk)("div",{class:"form-tip"},"默认值: 50.00",-1))]),_:1,__:[39]}),(0,o.bF)(i,null,{default:(0,o.k6)(()=>[(0,o.bF)(n,{type:"primary",onClick:r.updateDefaults,loading:r.defaultsSubmitting},{default:(0,o.k6)(()=>l[40]||(l[40]=[(0,o.eW)("保存")])),_:1,__:[40]},8,["onClick","loading"]),(0,o.bF)(n,{onClick:r.resetDefaults},{default:(0,o.k6)(()=>l[41]||(l[41]=[(0,o.eW)("恢复默认值")])),_:1,__:[41]},8,["onClick"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1},8,["modelValue"])]),_:1})])}var s=a(953),d=a(163),u=a(4335),i=a(5220),n={name:"SettingsPage",setup(){const e=(0,i.lq)(),l=(0,s.KR)("profile"),a=(0,s.KR)(null),t=(0,s.KR)(!1),r=(0,s.Kh)({username:"",email:""}),n={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度应为3-20个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱格式",trigger:"blur"}]},p=(0,s.KR)(null),m=(0,s.KR)(!1),c=(0,s.Kh)({currentPassword:"",newPassword:"",confirmPassword:""}),f=(e,l,a)=>{l!==c.newPassword?a(new Error("两次输入的密码不一致")):a()},b={currentPassword:[{required:!0,message:"请输入当前密码",trigger:"blur"}],newPassword:[{required:!0,message:"请输入新密码",trigger:"blur"},{min:6,message:"密码长度至少为6个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请再次输入新密码",trigger:"blur"},{validator:f,trigger:"blur"}]},_=(0,s.KR)(null),F=(0,s.KR)(!1),k=(0,s.KR)(!1),g=(0,s.Kh)({cozeApiToken:"",cozeWorkflowId:"",cozeBotId:""}),w=(0,s.KR)(null),V=(0,s.KR)(!1),y=(0,s.Kh)({item_biz_type:2,sp_biz_type:21,channel_cat_id:"9296cbae4daae3c4267e0a01017d9f44",express_fee:0,stock:1,stuff_status:0,spec_type:1,default_publish_count:5,default_image_count:3,default_price:50}),v={...y},h=async()=>{try{await new Promise(e=>setTimeout(e,500)),r.username="testuser",r.email="test@example.com"}catch(e){console.error("获取个人信息失败:",e),d.nk.error("获取个人信息失败")}},P=()=>{try{const e=localStorage.getItem("apiSettings");if(e){const l=JSON.parse(e);Object.assign(g,l)}}catch(e){console.error("获取API设置失败:",e)}},I=async()=>{try{await new Promise(e=>setTimeout(e,500));const e=localStorage.getItem("defaultSettings");if(e){const l=JSON.parse(e);Object.assign(y,l)}}catch(e){console.error("获取默认参数失败:",e),d.nk.error("获取默认参数失败")}},z=async()=>{a.value&&await a.value.validate(async e=>{if(e){t.value=!0;try{await new Promise(e=>setTimeout(e,1e3)),d.nk.success("个人信息更新成功")}catch(l){console.error("更新个人信息失败:",l),d.nk.error("更新个人信息失败，请重试")}finally{t.value=!1}}})},A=async()=>{p.value&&await p.value.validate(async e=>{if(e){m.value=!0;try{await new Promise(e=>setTimeout(e,1e3)),d.nk.success("密码修改成功"),c.currentPassword="",c.newPassword="",c.confirmPassword="",p.value.resetFields()}catch(l){console.error("修改密码失败:",l),d.nk.error("修改密码失败，请重试")}finally{m.value=!1}}})},S=async()=>{F.value=!0;try{localStorage.setItem("apiSettings",JSON.stringify(g)),d.nk.success("API设置保存成功")}catch(e){console.error("保存API设置失败:",e),d.nk.error("保存API设置失败，请重试")}finally{F.value=!1}},R=async()=>{if(g.cozeApiToken&&g.cozeWorkflowId){k.value=!0;try{const e=await u.A.post("/api/test-coze-api",{accessToken:g.cozeApiToken,workflowId:g.cozeWorkflowId,botId:g.cozeBotId||void 0});e.data.success?d.nk.success("API连接测试成功"):d.nk.error(`API连接失败: ${e.data.message}`)}catch(e){console.error("测试API连接失败:",e),d.nk.error("API连接测试失败，请检查配置")}finally{k.value=!1}}else d.nk.warning("请先填写API令牌和工作流ID")},C=async()=>{V.value=!0;try{await new Promise(e=>setTimeout(e,1e3)),localStorage.setItem("defaultSettings",JSON.stringify(y)),d.nk.success("默认参数更新成功")}catch(e){console.error("更新默认参数失败:",e),d.nk.error("更新默认参数失败，请重试")}finally{V.value=!1}},U=()=>{Object.assign(y,v),d.nk.success("已恢复默认值")};return(0,o.sV)(()=>{h(),P(),I(),e.query.tab&&["profile","password","api","defaults"].includes(e.query.tab)&&(l.value=e.query.tab)}),{activeTab:l,profileFormRef:a,profileSubmitting:t,profileForm:r,profileRules:n,passwordFormRef:p,passwordSubmitting:m,passwordForm:c,passwordRules:b,apiFormRef:_,apiSubmitting:F,apiTesting:k,apiForm:g,defaultsFormRef:w,defaultsSubmitting:V,defaultsForm:y,updateProfile:z,updatePassword:A,updateApiSettings:S,testCozeApi:R,updateDefaults:C,resetDefaults:U}}},p=a(6262);const m=(0,p.A)(n,[["render",r],["__scopeId","data-v-a5c25712"]]);var c=m}}]);
//# sourceMappingURL=586.87ebb110.js.map