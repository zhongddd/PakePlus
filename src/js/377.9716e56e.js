"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[377],{653:function(t,e,a){a.d(e,{BL:function(){return n},Cb:function(){return i},dP:function(){return o},gw:function(){return r},zZ:function(){return l}});var s=a(635);const o={getShops:()=>s.A.get("/api/shops"),addShop:t=>s.A.post("/api/shops",t),getShop:t=>s.A.get(`/api/shops/${t}`),updateShop:(t,e)=>s.A.put(`/api/shops/${t}`,e),deleteShop:t=>s.A.delete(`/api/shops/${t}`),queryShopInfo:t=>s.A.post(`/api/shops/${t}/query`),getShopAuthorize:t=>s.A.get(`/api/shops/${t}/authorize`)},i={getCategories:()=>s.A.get("/api/image-categories"),addCategory:t=>s.A.post("/api/image-categories",t),deleteCategory:(t,e={})=>s.A.delete(`/api/image-categories/${t}`,{params:e})},r={getImages:t=>s.A.get("/api/images",{params:t}),uploadImage:t=>s.A.post("/api/images/upload",t,{headers:{"Content-Type":"multipart/form-data"}}),compressImage:t=>s.A.post("/api/images/compress",{imageId:t})},n={generateDescription:(t,e={})=>s.A.post("/api/descriptions/generate",{keywords:t},e),generateDescriptionAsync:(t,e={})=>s.A.post("/api/descriptions/generate",{keywords:t,useAsyncMode:!0},e),checkAsyncResult:(t,e,a={})=>s.A.get(`/api/descriptions/async-result/${t}/${e}`,a)},l={getStats:()=>s.A.get("/api/dashboard")}},4114:function(t,e,a){var s=a(6518),o=a(8981),i=a(6198),r=a(4527),n=a(6837),l=a(9039),c=l(function(){return 4294967297!==[].push.call({length:4294967296},1)}),d=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}},p=c||!d();s({target:"Array",proto:!0,arity:1,forced:p},{push:function(t){var e=o(this),a=i(e),s=arguments.length;n(a+s);for(var l=0;l<s;l++)e[a]=arguments[l],a++;return r(e,a),a}})},4376:function(t,e,a){var s=a(2195);t.exports=Array.isArray||function(t){return"Array"===s(t)}},4527:function(t,e,a){var s=a(3724),o=a(4376),i=TypeError,r=Object.getOwnPropertyDescriptor,n=s&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(t){return t instanceof TypeError}}();t.exports=n?function(t,e){if(o(t)&&!r(t,"length").writable)throw new i("Cannot set read only .length");return t.length=e}:function(t,e){return t.length=e}},6377:function(t,e,a){a.r(e),a.d(e,{default:function(){return K}});var s=a(641),o=a(33);const i={class:"dashboard"},r={class:"stats-section"},n={class:"stats-grid"},l={class:"stats-icon"},c={class:"stats-content"},d={class:"stats-value"},p={class:"stats-icon"},u={class:"stats-content"},h={class:"stats-value"},g={class:"stats-card"},f={class:"stats-icon"},v={class:"stats-content"},k={class:"stats-value"},b={class:"shops-section"},y={class:"section-header"},m={class:"shops-content"},_={key:0,class:"empty-state"},L={class:"dashboard-grid"},w={class:"logs-section"},A={class:"logs-content"},C={class:"chart-section"},F={class:"chart-content"},S={class:"placeholder-chart"};function T(t,e,a,T,D,R){const z=(0,s.g2)("Shop"),P=(0,s.g2)("el-icon"),$=(0,s.g2)("Picture"),W=(0,s.g2)("Goods"),E=(0,s.g2)("Refresh"),I=(0,s.g2)("el-button"),K=(0,s.g2)("el-empty"),x=(0,s.g2)("el-table-column"),X=(0,s.g2)("el-tag"),O=(0,s.g2)("el-table"),j=(0,s.g2)("DataAnalysis"),q=(0,s.gN)("loading");return(0,s.uX)(),(0,s.CE)("div",i,[(0,s.Lk)("section",r,[e[6]||(e[6]=(0,s.Lk)("div",{class:"section-title"},[(0,s.Lk)("h2",null,"数据概览")],-1)),(0,s.Lk)("div",n,[(0,s.Lk)("div",{class:"stats-card",onClick:e[0]||(e[0]=t=>T.navigateTo("/shops"))},[(0,s.Lk)("div",l,[(0,s.bF)(P,null,{default:(0,s.k6)(()=>[(0,s.bF)(z)]),_:1})]),(0,s.Lk)("div",c,[(0,s.Lk)("div",d,(0,o.v_)(T.shopCount),1),e[3]||(e[3]=(0,s.Lk)("div",{class:"stats-label"},"店铺总数",-1))])]),(0,s.Lk)("div",{class:"stats-card",onClick:e[1]||(e[1]=t=>T.navigateTo("/images"))},[(0,s.Lk)("div",p,[(0,s.bF)(P,null,{default:(0,s.k6)(()=>[(0,s.bF)($)]),_:1})]),(0,s.Lk)("div",u,[(0,s.Lk)("div",h,(0,o.v_)(T.imageCount),1),e[4]||(e[4]=(0,s.Lk)("div",{class:"stats-label"},"图片总数",-1))])]),(0,s.Lk)("div",g,[(0,s.Lk)("div",f,[(0,s.bF)(P,null,{default:(0,s.k6)(()=>[(0,s.bF)(W)]),_:1})]),(0,s.Lk)("div",v,[(0,s.Lk)("div",k,(0,o.v_)(T.publishedCount),1),e[5]||(e[5]=(0,s.Lk)("div",{class:"stats-label"},"已发布商品",-1))])])])]),(0,s.Lk)("section",b,[(0,s.Lk)("div",y,[e[8]||(e[8]=(0,s.Lk)("div",{class:"section-title"},[(0,s.Lk)("h2",null,"授权店铺")],-1)),(0,s.bF)(I,{type:"primary",onClick:T.refreshAuthShops,loading:T.shopLoading},{default:(0,s.k6)(()=>[(0,s.bF)(P,null,{default:(0,s.k6)(()=>[(0,s.bF)(E)]),_:1}),e[7]||(e[7]=(0,s.Lk)("span",null,"刷新",-1))]),_:1,__:[7]},8,["onClick","loading"])]),(0,s.bo)(((0,s.uX)(),(0,s.CE)("div",m,[T.shopLoading||T.authorizedShops.length?!T.shopLoading&&T.authorizedShops.length>0?((0,s.uX)(),(0,s.Wv)(O,{key:1,data:T.authorizedShops,style:{width:"100%"},stripe:!0,border:!1,class:"apple-table"},{default:(0,s.k6)(()=>[(0,s.bF)(x,{prop:"shop_name",label:"店铺名称","min-width":"120"}),(0,s.bF)(x,{prop:"user_name",label:"会员名","min-width":"120"}),(0,s.bF)(x,{prop:"user_nick",label:"昵称","min-width":"120"}),(0,s.bF)(x,{prop:"is_pro",label:"鱼小铺"},{default:(0,s.k6)(t=>[(0,s.bF)(X,{type:t.row.is_pro?"success":"info",effect:"plain"},{default:(0,s.k6)(()=>[(0,s.eW)((0,o.v_)(t.row.is_pro?"已开通":"未开通"),1)]),_:2},1032,["type"])]),_:1}),(0,s.bF)(x,{prop:"is_valid",label:"订购状态"},{default:(0,s.k6)(t=>[(0,s.bF)(X,{type:t.row.is_valid?"success":"danger",effect:"plain"},{default:(0,s.k6)(()=>[(0,s.eW)((0,o.v_)(t.row.is_valid?"有效":"无效"),1)]),_:2},1032,["type"])]),_:1}),(0,s.bF)(x,{prop:"valid_end_time",label:"有效期"},{default:(0,s.k6)(t=>[(0,s.eW)((0,o.v_)(T.formatTimestamp(t.row.valid_end_time)),1)]),_:1})]),_:1},8,["data"])):(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",_,[(0,s.bF)(K,{description:"暂无授权店铺，请在店铺管理页面查询店铺获取授权信息"},{default:(0,s.k6)(()=>[(0,s.bF)(I,{type:"primary",onClick:e[2]||(e[2]=t=>T.navigateTo("/shops"))},{default:(0,s.k6)(()=>e[9]||(e[9]=[(0,s.eW)("前往店铺管理")])),_:1,__:[9]})]),_:1})]))])),[[q,T.shopLoading]])]),(0,s.Lk)("div",L,[(0,s.Lk)("section",w,[e[10]||(e[10]=(0,s.Lk)("div",{class:"section-title"},[(0,s.Lk)("h2",null,"最近发布记录")],-1)),(0,s.Lk)("div",A,[(0,s.bo)(((0,s.uX)(),(0,s.Wv)(O,{data:T.recentLogs,style:{width:"100%"},stripe:!0,border:!1,class:"apple-table"},{default:(0,s.k6)(()=>[(0,s.bF)(x,{prop:"title",label:"商品标题","min-width":"180","show-overflow-tooltip":""}),(0,s.bF)(x,{prop:"price",label:"价格",width:"100"}),(0,s.bF)(x,{prop:"created_at",label:"发布时间",width:"180"},{default:(0,s.k6)(t=>[(0,s.eW)((0,o.v_)(T.formatDate(t.row.created_at)),1)]),_:1}),(0,s.bF)(x,{prop:"status",label:"状态",width:"120"},{default:(0,s.k6)(t=>[(0,s.bF)(X,{type:T.getStatusType(t.row.status),effect:"plain"},{default:(0,s.k6)(()=>[(0,s.eW)((0,o.v_)(t.row.status),1)]),_:2},1032,["type"])]),_:1})]),_:1},8,["data"])),[[q,T.loading]])])]),(0,s.Lk)("section",C,[e[11]||(e[11]=(0,s.Lk)("div",{class:"section-title"},[(0,s.Lk)("h2",null,"近期发布统计")],-1)),(0,s.Lk)("div",F,[(0,s.Lk)("div",S,[(0,s.bF)(K,{description:"数据统计功能正在开发中"},{image:(0,s.k6)(()=>[(0,s.bF)(P,null,{default:(0,s.k6)(()=>[(0,s.bF)(j)]),_:1})]),_:1})])])])])])}a(4114);var D=a(953),R=a(5220),z=a(653),P=a(163),$=a(8548),W={name:"DashboardPage",components:{Shop:$.Shop,Picture:$.Picture,Goods:$.Goods,Refresh:$.Refresh,DataAnalysis:$.DataAnalysis},setup(){const t=(0,R.rd)(),e=(0,D.KR)(0),a=(0,D.KR)(0),o=(0,D.KR)(0),i=(0,D.KR)([]),r=(0,D.KR)(!1),n=(0,D.KR)(!1),l=(0,D.KR)([]),c=async()=>{r.value=!0;try{const t=await z.zZ.getStats(),{data:s}=t.data;e.value=s.shopCount||0,a.value=s.imageCount||0,o.value=s.publishedCount||0,i.value=Array.isArray(s.recentLogs)?s.recentLogs:[]}catch(t){console.error("获取仪表盘数据失败:",t),P.nk.error("获取仪表盘数据失败，请稍后重试"),e.value=0,a.value=0,o.value=0,i.value=[]}finally{r.value=!1}},d=async()=>{try{n.value=!0;const e=await z.dP.getShops(),a=e.data.data;if(l.value=[],!a||0===a.length)return;for(const s of a)try{const t=await z.dP.queryShopInfo(s.id);t.data&&t.data.data&&t.data.data.shops&&(l.value=l.value.concat(t.data.data.shops))}catch(t){console.error(`获取店铺${s.id}的授权信息失败:`,t)}}catch(t){console.error("加载授权店铺数据失败:",t),l.value=[],P.nk.error("获取授权店铺数据失败")}finally{n.value=!1}},p=async()=>{try{await d(),P.nk.success("授权店铺数据已刷新")}catch(t){P.nk.error("刷新授权店铺数据失败")}},u=t=>{if(!t||0===t)return"无";const e=new Date(1e3*t);return e.toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"})},h=t=>"published"===t?"success":"failed"===t?"danger":"info",g=t=>{if(!t)return"";const e=new Date(t);return e.toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},f=e=>{t.push(e)};return(0,s.sV)(()=>{c(),d()}),{shopCount:e,imageCount:a,publishedCount:o,recentLogs:i,loading:r,shopLoading:n,authorizedShops:l,getStatusType:h,formatDate:g,formatTimestamp:u,refreshAuthShops:p,navigateTo:f}}},E=a(6262);const I=(0,E.A)(W,[["render",T],["__scopeId","data-v-32b37352"]]);var K=I},6837:function(t){var e=TypeError,a=9007199254740991;t.exports=function(t){if(t>a)throw e("Maximum allowed index exceeded");return t}}}]);
//# sourceMappingURL=377.9716e56e.js.map