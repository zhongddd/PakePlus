"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[580],{653:function(e,t,o){o.d(t,{BL:function(){return i},Cb:function(){return a},dP:function(){return s},gw:function(){return r},zZ:function(){return l}});var n=o(635);const s={getShops:()=>n.A.get("/api/shops"),addShop:e=>n.A.post("/api/shops",e),getShop:e=>n.A.get(`/api/shops/${e}`),updateShop:(e,t)=>n.A.put(`/api/shops/${e}`,t),deleteShop:e=>n.A.delete(`/api/shops/${e}`),queryShopInfo:e=>n.A.post(`/api/shops/${e}/query`),getShopAuthorize:e=>n.A.get(`/api/shops/${e}/authorize`)},a={getCategories:()=>n.A.get("/api/image-categories"),addCategory:e=>n.A.post("/api/image-categories",e),deleteCategory:(e,t={})=>n.A.delete(`/api/image-categories/${e}`,{params:t})},r={getImages:e=>n.A.get("/api/images",{params:e}),uploadImage:e=>n.A.post("/api/images/upload",e,{headers:{"Content-Type":"multipart/form-data"}}),compressImage:e=>n.A.post("/api/images/compress",{imageId:e})},i={generateDescription:(e,t={})=>n.A.post("/api/descriptions/generate",{keywords:e},t),generateDescriptionAsync:(e,t={})=>n.A.post("/api/descriptions/generate",{keywords:e,useAsyncMode:!0},t),checkAsyncResult:(e,t,o={})=>n.A.get(`/api/descriptions/async-result/${e}/${t}`,o)},l={getStats:()=>n.A.get("/api/dashboard")}},4114:function(e,t,o){var n=o(6518),s=o(8981),a=o(6198),r=o(4527),i=o(6837),l=o(9039),c=l(function(){return 4294967297!==[].push.call({length:4294967296},1)}),d=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(e){return e instanceof TypeError}},u=c||!d();n({target:"Array",proto:!0,arity:1,forced:u},{push:function(e){var t=s(this),o=a(t),n=arguments.length;i(o+n);for(var l=0;l<n;l++)t[o]=arguments[l],o++;return r(t,o),o}})},4376:function(e,t,o){var n=o(2195);e.exports=Array.isArray||function(e){return"Array"===n(e)}},4527:function(e,t,o){var n=o(3724),s=o(4376),a=TypeError,r=Object.getOwnPropertyDescriptor,i=n&&!function(){if(void 0!==this)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}();e.exports=i?function(e,t){if(s(e)&&!r(e,"length").writable)throw new a("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t}},6580:function(e,t,o){o.r(t),o.d(t,{default:function(){return K}});var n=o(641),s=o(33);const a={class:"description-tester"},r={class:"card-header"},i={key:0},l={key:0},c={key:1},d={key:2},u={class:"settings-actions"},p={class:"main-content"},k={class:"generator-container"},g={class:"preview-container"},f={class:"preview-text"},y={class:"preview-actions"};function m(e,t,o,m,v,_){const h=(0,n.g2)("el-button"),b=(0,n.g2)("el-alert"),w=(0,n.g2)("el-input"),A=(0,n.g2)("el-form-item"),S=(0,n.g2)("el-form"),C=(0,n.g2)("el-card"),I=(0,n.g2)("el-divider"),z=(0,n.g2)("el-switch"),F=(0,n.g2)("DescriptionGenerator"),W=(0,n.g2)("el-empty");return(0,n.uX)(),(0,n.CE)("div",a,[t[27]||(t[27]=(0,n.Lk)("h1",null,"商品描述生成测试",-1)),m.hideSettings?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.Wv)(C,{key:0,class:"api-settings-card"},{header:(0,n.k6)(()=>[(0,n.Lk)("div",r,[t[10]||(t[10]=(0,n.Lk)("span",null,"Coze API 设置",-1)),(0,n.bF)(h,{type:"text",onClick:t[0]||(t[0]=e=>m.hideSettings=!0)},{default:(0,n.k6)(()=>t[9]||(t[9]=[(0,n.eW)("隐藏")])),_:1,__:[9]})])]),default:(0,n.k6)(()=>[m.useStoredSettings?((0,n.uX)(),(0,n.CE)("div",i,[(0,n.bF)(b,{type:"success","show-icon":"",closable:!1},{default:(0,n.k6)(()=>[t[11]||(t[11]=(0,n.Lk)("p",null,"当前使用设置页面保存的API配置",-1)),m.cozeSettings.cozeApiToken?((0,n.uX)(),(0,n.CE)("p",l,"API令牌: "+(0,s.v_)(m.maskToken(m.cozeSettings.cozeApiToken)),1)):(0,n.Q3)("",!0),m.cozeSettings.cozeWorkflowId?((0,n.uX)(),(0,n.CE)("p",c,"工作流ID: "+(0,s.v_)(m.cozeSettings.cozeWorkflowId),1)):(0,n.Q3)("",!0),m.cozeSettings.cozeBotId?((0,n.uX)(),(0,n.CE)("p",d,"智能体ID: "+(0,s.v_)(m.cozeSettings.cozeBotId),1)):(0,n.Q3)("",!0)]),_:1,__:[11]}),(0,n.Lk)("div",u,[(0,n.bF)(h,{type:"primary",onClick:m.testConnection},{default:(0,n.k6)(()=>t[12]||(t[12]=[(0,n.eW)("测试连接")])),_:1,__:[12]},8,["onClick"]),(0,n.bF)(h,{onClick:t[1]||(t[1]=e=>m.useStoredSettings=!1)},{default:(0,n.k6)(()=>t[13]||(t[13]=[(0,n.eW)("使用自定义设置")])),_:1,__:[13]}),(0,n.bF)(h,{onClick:m.goToSettings},{default:(0,n.k6)(()=>t[14]||(t[14]=[(0,n.eW)("去设置页管理")])),_:1,__:[14]},8,["onClick"])])])):((0,n.uX)(),(0,n.Wv)(S,{key:1,model:m.customSettings,"label-position":"top"},{default:(0,n.k6)(()=>[(0,n.bF)(A,{label:"Coze API 令牌"},{default:(0,n.k6)(()=>[(0,n.bF)(w,{modelValue:m.customSettings.cozeApiToken,"onUpdate:modelValue":t[2]||(t[2]=e=>m.customSettings.cozeApiToken=e),placeholder:"请输入Coze API令牌"},null,8,["modelValue"])]),_:1}),(0,n.bF)(A,{label:"工作流ID"},{default:(0,n.k6)(()=>[(0,n.bF)(w,{modelValue:m.customSettings.cozeWorkflowId,"onUpdate:modelValue":t[3]||(t[3]=e=>m.customSettings.cozeWorkflowId=e),placeholder:"请输入工作流ID"},null,8,["modelValue"])]),_:1}),(0,n.bF)(A,{label:"智能体ID (可选)"},{default:(0,n.k6)(()=>[(0,n.bF)(w,{modelValue:m.customSettings.cozeBotId,"onUpdate:modelValue":t[4]||(t[4]=e=>m.customSettings.cozeBotId=e),placeholder:"请输入智能体ID (可选)"},null,8,["modelValue"])]),_:1}),(0,n.bF)(A,null,{default:(0,n.k6)(()=>[(0,n.bF)(h,{type:"primary",onClick:m.testCustomConnection},{default:(0,n.k6)(()=>t[15]||(t[15]=[(0,n.eW)("测试连接")])),_:1,__:[15]},8,["onClick"]),(0,n.bF)(h,{onClick:t[5]||(t[5]=e=>m.useStoredSettings=!0)},{default:(0,n.k6)(()=>t[16]||(t[16]=[(0,n.eW)("使用全局设置")])),_:1,__:[16]})]),_:1})]),_:1},8,["model"]))]),_:1})),m.hideSettings?((0,n.uX)(),(0,n.Wv)(h,{key:1,type:"text",onClick:t[6]||(t[6]=e=>m.hideSettings=!1),class:"show-settings-btn"},{default:(0,n.k6)(()=>t[17]||(t[17]=[(0,n.eW)(" 显示API设置 ")])),_:1,__:[17]})):(0,n.Q3)("",!0),(0,n.bF)(I,{"content-position":"center"},{default:(0,n.k6)(()=>t[18]||(t[18]=[(0,n.eW)("API调用配置")])),_:1,__:[18]}),(0,n.bF)(b,{type:"info","show-icon":"",closable:!1,style:{"margin-bottom":"20px"}},{default:(0,n.k6)(()=>t[19]||(t[19]=[(0,n.Lk)("p",null,"由于CozeAPI接口调用可能超时，建议开启异步模式",-1)])),_:1,__:[19]}),(0,n.bF)(C,{class:"settings-card"},{default:(0,n.k6)(()=>[(0,n.bF)(A,{label:"默认使用异步模式","label-width":"150px"},{default:(0,n.k6)(()=>[(0,n.bF)(z,{modelValue:m.defaultUseAsync,"onUpdate:modelValue":t[7]||(t[7]=e=>m.defaultUseAsync=e),onChange:m.saveDefaultSettings},null,8,["modelValue","onChange"]),t[20]||(t[20]=(0,n.Lk)("span",{class:"setting-description"},"开启后会使用异步API调用方式，避免超时问题",-1))]),_:1,__:[20]})]),_:1}),(0,n.bF)(I,{"content-position":"center"},{default:(0,n.k6)(()=>t[21]||(t[21]=[(0,n.eW)("商品描述生成")])),_:1,__:[21]}),(0,n.bF)(S,{model:m.testForm,class:"test-form"},{default:(0,n.k6)(()=>[(0,n.bF)(A,{label:"测试关键词"},{default:(0,n.k6)(()=>[(0,n.bF)(w,{modelValue:m.testForm.keywords,"onUpdate:modelValue":t[8]||(t[8]=e=>m.testForm.keywords=e),placeholder:"请输入要测试的商品关键词，多个关键词用逗号分隔",type:"text"},null,8,["modelValue"])]),_:1}),(0,n.bF)(A,null,{default:(0,n.k6)(()=>[(0,n.bF)(h,{type:"primary",onClick:m.quickTest},{default:(0,n.k6)(()=>t[22]||(t[22]=[(0,n.eW)("快速测试")])),_:1,__:[22]},8,["onClick"]),(0,n.bF)(h,{onClick:m.clearKeywords},{default:(0,n.k6)(()=>t[23]||(t[23]=[(0,n.eW)("清空")])),_:1,__:[23]},8,["onClick"])]),_:1})]),_:1},8,["model"]),(0,n.Lk)("div",p,[(0,n.Lk)("div",k,[(0,n.bF)(F,{ref:"generatorRef",onUseDescription:m.handleUseDescription,apiSettings:m.getActiveSettings(),initialKeywords:m.testForm.keywords},null,8,["onUseDescription","apiSettings","initialKeywords"])]),(0,n.bF)(I,{direction:"vertical"}),(0,n.Lk)("div",g,[t[26]||(t[26]=(0,n.Lk)("h2",null,"描述预览",-1)),m.currentDescription?((0,n.uX)(),(0,n.Wv)(C,{key:0,class:"preview-card"},{default:(0,n.k6)(()=>[(0,n.Lk)("div",f,(0,s.v_)(m.currentDescription),1),(0,n.Lk)("div",y,[(0,n.bF)(h,{size:"small",type:"primary",onClick:m.copyToClipboard},{default:(0,n.k6)(()=>t[24]||(t[24]=[(0,n.eW)("复制描述")])),_:1,__:[24]},8,["onClick"]),(0,n.bF)(h,{size:"small",onClick:m.clearPreview},{default:(0,n.k6)(()=>t[25]||(t[25]=[(0,n.eW)("清除")])),_:1,__:[25]},8,["onClick"])])]),_:1})):((0,n.uX)(),(0,n.Wv)(W,{key:1,description:"还没有生成的描述"}))])])])}o(4114);var v=o(953),_=o(163),h=o(5220);const b={class:"description-generator"},w={key:0,class:"generated-description"},A={class:"description-header"},S={class:"description-text"};function C(e,t,o,a,r,i){const l=(0,n.g2)("el-input"),c=(0,n.g2)("el-form-item"),d=(0,n.g2)("el-button"),u=(0,n.g2)("el-form"),p=(0,n.g2)("el-card");return(0,n.uX)(),(0,n.CE)("div",b,[(0,n.bF)(u,{ref:"form",model:a.form,"label-position":"top"},{default:(0,n.k6)(()=>[(0,n.bF)(c,{label:"商品关键词",prop:"keywords"},{default:(0,n.k6)(()=>[(0,n.bF)(l,{modelValue:a.form.keywords,"onUpdate:modelValue":t[0]||(t[0]=e=>a.form.keywords=e),placeholder:"输入关键词，多个关键词用逗号分隔",type:"textarea",rows:2},null,8,["modelValue"])]),_:1}),(0,n.bF)(c,null,{default:(0,n.k6)(()=>[(0,n.bF)(d,{type:"primary",onClick:a.generateDescription,loading:a.loading},{default:(0,n.k6)(()=>t[1]||(t[1]=[(0,n.eW)(" 生成描述 ")])),_:1,__:[1]},8,["onClick","loading"])]),_:1})]),_:1},8,["model"]),a.description?((0,n.uX)(),(0,n.CE)("div",w,[(0,n.Lk)("div",A,[t[4]||(t[4]=(0,n.Lk)("h3",null,"生成的商品描述",-1)),(0,n.Lk)("div",null,[(0,n.bF)(d,{type:"primary",size:"small",onClick:a.useDescription},{default:(0,n.k6)(()=>t[2]||(t[2]=[(0,n.eW)(" 使用此描述 ")])),_:1,__:[2]},8,["onClick"]),(0,n.bF)(d,{size:"small",onClick:a.regenerate},{default:(0,n.k6)(()=>t[3]||(t[3]=[(0,n.eW)(" 重新生成 ")])),_:1,__:[3]},8,["onClick"])])]),(0,n.bF)(p,{class:"description-content"},{default:(0,n.k6)(()=>[(0,n.Lk)("div",S,(0,s.v_)(a.description),1)]),_:1})])):(0,n.Q3)("",!0)])}var I=o(653),z={name:"DescriptionGenerator",props:{apiSettings:{type:Object,default:()=>({})},initialKeywords:{type:String,default:""}},emits:["use-description"],setup(e,{emit:t}){const o=(0,v.Kh)({keywords:e.initialKeywords||""});(0,n.wB)(()=>e.initialKeywords,e=>{void 0!==e&&(o.keywords=e)});const s=(0,v.KR)(!1),a=(0,v.KR)(""),r=async()=>{if(o.keywords.trim())try{s.value=!0;const t={};e.apiSettings&&Object.keys(e.apiSettings).length>0&&(t.headers={"X-Coze-Settings":JSON.stringify(e.apiSettings)});const n=await I.BL.generateDescription(o.keywords,t);a.value=n.data.data.description,_.nk.success("描述生成成功")}catch(t){console.error("生成描述失败:",t),_.nk.error(t.response?.data?.message||"生成描述失败，请重试")}finally{s.value=!1}else _.nk.warning("请输入商品关键词")},i=()=>{r()},l=()=>{t("use-description",a.value)};return{form:o,loading:s,description:a,generateDescription:r,regenerate:i,useDescription:l}}},F=o(6262);const W=(0,F.A)(z,[["render",C],["__scopeId","data-v-541f0a66"]]);var D=W,T=o(4335),L={name:"DescriptionTester",components:{DescriptionGenerator:D},setup(){const e=(0,h.rd)(),t=(0,v.KR)({cozeApiToken:"",cozeWorkflowId:"",cozeBotId:""}),o=(0,v.KR)({cozeApiToken:"",cozeWorkflowId:"",cozeBotId:""}),n=(0,v.KR)(!0),s=(0,v.KR)(!0),a=(0,v.KR)(!1),r=(0,v.KR)(""),i=(0,v.KR)({keywords:""}),l=(0,v.KR)(null),c=()=>{const e=localStorage.getItem("apiSettings");if(e)try{const o=JSON.parse(e);t.value={...t.value,...o},t.value.cozeApiToken&&t.value.cozeWorkflowId||(s.value=!1)}catch(o){console.error("加载设置失败:",o),s.value=!1}else s.value=!1;try{const e=localStorage.getItem("defaultUseAsync");null!==e&&(n.value=JSON.parse(e))}catch(o){console.error("加载异步设置失败:",o)}},d=()=>{localStorage.setItem("defaultUseAsync",JSON.stringify(n.value)),_.nk.success("设置已保存")},u=()=>{const e=s.value?t.value:o.value;return{...e,useAsyncMode:n.value}},p=e=>e?e.length<=10?e:e.substring(0,5)+"..."+e.substring(e.length-5):"",k=async()=>{if(t.value.cozeApiToken&&t.value.cozeWorkflowId)try{const e=await T.A.post("/api/test-coze-api",{accessToken:t.value.cozeApiToken,workflowId:t.value.cozeWorkflowId,botId:t.value.cozeBotId||void 0});e.data.success?_.nk.success("连接测试成功"):_.nk.error(`连接测试失败: ${e.data.message}`)}catch(e){console.error("API测试失败:",e),_.nk.error(e.response?.data?.message||"连接测试失败")}else _.nk.warning("全局设置中缺少API令牌或工作流ID，请先在设置页面完成配置")},g=async()=>{if(o.value.cozeApiToken&&o.value.cozeWorkflowId)try{const e=await T.A.post("/api/test-coze-api",{accessToken:o.value.cozeApiToken,workflowId:o.value.cozeWorkflowId,botId:o.value.cozeBotId||void 0});e.data.success?_.nk.success("连接测试成功"):_.nk.error(`连接测试失败: ${e.data.message}`)}catch(e){console.error("API测试失败:",e),_.nk.error(e.response?.data?.message||"连接测试失败")}else _.nk.warning("请输入API令牌和工作流ID")},f=()=>{e.push("/settings")},y=e=>{r.value=e},m=async()=>{try{await navigator.clipboard.writeText(r.value),_.nk.success("描述已复制到剪贴板")}catch(e){console.error("复制失败:",e),_.nk.error("复制失败，请手动复制")}},b=()=>{r.value=""},w=async()=>{if(i.value.keywords)if(l.value&&"function"===typeof l.value.generateDescription)await l.value.generateDescription();else{const e=document.querySelector(".description-generator .el-button");e?e.click():_.nk.error("无法触发描述生成")}else _.nk.warning("请先输入测试关键词")},A=()=>{i.value.keywords=""};return c(),{cozeSettings:t,customSettings:o,defaultUseAsync:n,useStoredSettings:s,hideSettings:a,currentDescription:r,testForm:i,testConnection:k,testCustomConnection:g,handleUseDescription:y,copyToClipboard:m,clearPreview:b,getActiveSettings:u,maskToken:p,goToSettings:f,saveDefaultSettings:d,quickTest:w,clearKeywords:A,generatorRef:l}}};const P=(0,F.A)(L,[["render",m],["__scopeId","data-v-43d923d0"]]);var K=P},6837:function(e){var t=TypeError,o=9007199254740991;e.exports=function(e){if(e>o)throw t("Maximum allowed index exceeded");return e}}}]);
//# sourceMappingURL=580.bf30951b.js.map